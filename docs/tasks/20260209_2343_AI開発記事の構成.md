# AI開発記事の構成

## 目的

AI（Claude Code）を活用して短期間で堅牢なアプリケーションを開発したノウハウを、選挙というキャッチーな文脈と絡めて記事化する。「急いでいるときに、実装の詳細を見ずに堅牢なアプリを作るための、自分なりに到達したコツ」を共有する。

## 記事構成

### 1. 設計: DDD/Clean Archで「何を守るか」を決める

#### 1-1. 思想とルール

- Bounded Context分離（clip-video / shorts-gen / shared）
- 各BC内の4層レイヤー（presentation → application → domain → infrastructure）
- Domain層だけResult型、他層はthrow — 層ごとにエラー戦略を変えるプラグマティックDDD
- Gatewayパターンで共有Infrastructureが複数BCのインターフェースを実装（Shared Kernelをクリーンに実現）
- tsconfig pathsの`@clip-video/*`、`@shorts-gen/*`でimport文からBC境界が一目で分かる
- フロントエンド（Next.js App Router）にも同じDDD的レイヤー分離を適用（server/presentation/actions, server/infrastructure/clients）

#### 1-2. dep-cruiserで「崩れ」を機械的に検出

- バックエンド: domain→application禁止、BC間直接依存禁止など
- フロントエンド: UI→features禁止、features→features禁止（これはあまり見ない）
- CIで毎回チェック — 人間のレビューに頼らない

#### 1-3. テスト戦略もレイヤーに紐づける

- domain/application → unit（mock）
- infrastructure → integration（実DB）
- webapp → e2e（Playwright）

### 2. 実装: Claude Codeで速く・壊さず作る

#### 2-1. AIに文脈を注入する仕組み

- CLAUDE.mdは「AIへのオンボーディングドキュメント」
- BC×レイヤー単位のslash command（`/backend-clip-video`等）で、どのガイドを読み・どのディレクトリを触るかを自動把握させる
  - AIのコンテキストウィンドウを意識した設計で、まだほとんど見ない工夫
  - 人間のオンボーディングと同じ発想をAIに適用
- `/review`でAIが`git diff`をアーキテクチャガイドラインに照合してセルフレビュー
  - dep-cruiserでは拾えない意味的な設計違反をカバーする層
- `.claude/settings.local.json`の許可リストでAIの操作権限を制御（blast radius管理）

#### 2-2. docs/tasksによる並列SDD（Spec-Driven Development）

- `/plan`コマンドで「目的（Why）」を必ず明文化 → `docs/tasks/YYYYMMDD_HHMM_{作業内容}.md`に生成
- この設計ドキュメントがClaude Code Webへの「仕様書」になり、並列に指示を飛ばせる
- 完了後は`docs/tasks/old/`にアーカイブ → 設計判断の履歴が残る

#### 2-3. ガードレール: CIに到達する前に落とす

- pre-commit: `lint-staged`（変更ファイルだけBiome check）
- pre-push: `lint && typecheck`（全体チェック）
- CI: Biome + Knip（デッドコード検出）+ dep-cruiser + テスト
- `--no-verify`は原則禁止とCLAUDE.mdに明記 — AIにもルールを守らせる
- Knip + Biome + dep-cruiserの3点セットで「使われていないコード」「フォーマット崩れ」「依存方向違反」を継続的に刈り取る

## 差別化ポイント（厚めに書くべき箇所）

以下は「やっている人がまだ少ない」ため、記事の目玉になる:

1. **BC単位のslash command** — AIのコンテキスト注入を構造化
2. **`/plan` → docs/tasks → Claude Code Web並列実行** — SDDの具体的パイプライン
3. **`/review`によるAIセルフレビュー** — 静的チェックと人間レビューの間の層
4. **dep-cruiserのフロントエンド適用** — Next.jsでfeatures間依存を禁止

---

## 文体ガイド（参考: まるみえ政治資金記事の分析）

以下は `ref_まるみえ政治資金記事.md` の文体特徴を分析したもの。記事執筆時にこのトーンに寄せること。

### 1. 語り口・一人称

- 一人称は「自分」「僕」を場面で使い分け（冒頭の自己紹介は「私」、本文中の体験談は「自分」「僕」）
- 読者に語りかけるような話し言葉調。「〜なんです」「〜なんですが」「〜してみてはいかがでしょうか！」
- 堅い技術記事ではなく、勉強会のLTで喋っているような親しみやすさ

### 2. 語尾パターン

- **断定を避ける柔らかい語尾が基本**: 「〜と思っています」「〜と考えています」「〜のではないかと思いました」「〜ように感じています」
- **提案・おすすめ系**: 「〜のがおすすめです」「〜が効果的です」「〜が良いと思います」
- **断定するのは事実・数値のみ**: 「95%以上のコードをLLMが実装している」「私がHTMLやCSSを書いた部分はゼロ」
- 主観的な主張ほど語尾を柔らかくし、客観的な事実はハッキリ言い切る

### 3. 太字（**）の使い方

- 各パラグラフの核心メッセージを太字にする（1段落に1〜2箇所）
- 流し読みしても太字だけ拾えば主張が分かるレベルで設計されている
- 例: 「**ほとんどのコードをLLMに実装させつつ外部品質・内部品質の高いアプリケーションを構築しようとした**」

### 4. 構成パターン

- **マクロ→ミクロの階層構造**: 大きなレイヤーの話から具体的なテクニックへ降りていく
- **見出し→導入文→箇条書き→解説の繰り返し**: セクション冒頭で概要を述べ、箇条書きで列挙し、それぞれを解説
- **セクション末に小まとめ**: 「〜のまとめ」で要点を再度太字で要約
- **最後のまとめ**では全セクションを振り返り、横断的なメッセージで締める

### 5. 免責・謙虚さの表現

- 記事冒頭に「とても大事な注意事項」として「絶対的な方法論ではない」と明記
- 前提条件（フルスクラッチ、得意な技術スタック、中規模サイズ）を正直に列挙
- 末尾でも「既存レガシーコードには適さないこともある」と繰り返す
- 「僕はこうやったら結構うまくいったよ」くらいの温度感を一貫して保つ

### 6. 接続・つなぎの表現

- 話し言葉的な接続: 「ということで」「ところで」「というわけで」「ちなみに」「また」「つづいて」
- セクション間の橋渡しが自然で、論文調にならない
- 「見てきた通り」「振り返ると」で既出の内容を参照

### 7. 具体例・数字の出し方

- 主張に対して必ず具体例や数値を添える: 「15,000行程度」「約45日」「約2日で20万PV」
- スクリーンショットや図を挟んでビジュアルに説明
- 外部記事・リポジトリへのリンクで根拠を示す

### 8. 今回の記事に適用する際の注意

- 上記の文体を踏襲しつつ、今回は「2つ目の事例記事」なので前回記事を引用しつつ深掘りする立場
- 前回は「95%をLLMが実装」が見出しの核。今回は「実装の詳細を見ずに堅牢なアプリを作る」が核なので、設計・ガードレール寄りの話に重心を置く
- 前回記事と重複するポイント（CLAUDE.md、レイヤー分け、テスト戦略など）は「前回も紹介しましたが、今回はさらに〜」のように接続し、新規性を出す
