# 設計書: 台本作成の手動モード削除

## 目的

ユーザーが台本作成時にモード選択で迷うことなく、スムーズにAIチャットで台本を作成できるようにするため。

## 概要

台本作成ステップから「手動で新規作成」モードを削除し、必ずAIチャット経由で台本を作成するようにする。

## 現状

現在の `ScriptGenerationStep` コンポーネントには2つの作成モードがある：

```
┌─────────────────────────────────────┐
│  台本を作成する方法を選択してください：  │
│                                     │
│  ┌──────────┐  ┌──────────┐         │
│  │  🤖      │  │  ✏️      │         │
│  │ AI生成   │  │ 手動作成  │  ← 削除対象 │
│  │          │  │          │         │
│  └──────────┘  └──────────┘         │
└─────────────────────────────────────┘
```

### 関連ファイル

| ファイル | 変更内容 |
|----------|----------|
| [script-generation-step.tsx](../../apps/webapp/src/components/features/shorts-gen/script/script-generation-step.tsx) | モード選択UI削除、手動モード関連ロジック削除 |
| [use-script-generation.ts](../../apps/webapp/src/components/features/shorts-gen/script/use-script-generation.ts) | `createManualScript` 関数は残す（将来的な削除候補） |
| [project-detail-client.tsx](../../apps/webapp/src/app/shorts-gen/[projectId]/project-detail-client.tsx) | `onCreateManualScript` プロパティ削除 |

## 変更後のUI

```
┌─────────────────────────────────────┐
│  🎬 台本を作成                       │
│  企画書をもとに、シーンごとの台本を    │
│  生成します                          │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 📝 台本生成チャット            │    │
│  │                             │    │
│  │ 台本に関する指示を入力...      │    │
│  │ (例: 「シーンを5つに分けて...」) │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

企画書が作成されたら、モード選択画面をスキップして直接チャットUIを表示する。

## 詳細設計

### 1. ScriptGenerationStep コンポーネントの変更

#### 削除する要素

- `ScriptCreationMode` 型から `'select'` と `'manual'` を削除
- `mode` state を削除（常にAIモード）
- モード選択UI（`mode === 'select'` の分岐）を削除
- 手動作成関連のハンドラを削除：
  - `handleSelectManualMode`
  - `handleAddNewScene`
  - `handleSaveNewScene`
  - `handleCancelNewScene`
- 手動モード関連のstate削除：
  - `isCreatingScript`
  - `isAddingNewScene`
- 手動モード用のprops削除：
  - `onCreateManualScript`
  - `onAddScene`
- 手動モード専用のUI削除：
  - 「手動作成」ボタン
  - 新規シーン追加ボタン（手動モード用）
  - 新規シーン編集フォーム
  - 手動モードの空状態UI

#### 残す要素

- `ChatUI` コンポーネント（AI生成）
- `SceneList` コンポーネント（生成済みシーンの表示・編集）
- `SceneEditor` コンポーネント（既存シーンの編集）
- シーン編集ハンドラ（`handleEditScene`, `handleSaveScene`, `handleCancelEdit`）

### 2. Props の変更

```typescript
// Before
interface ScriptGenerationStepProps {
  projectId: string;
  planningId: string | null;
  script: Script | null;
  scenes: Scene[];
  status: ScriptGenerationStatus;
  onScriptGenerated?: (script: Script, scenes: Scene[]) => void;
  onSceneUpdated?: (scene: Scene) => void;
  onSaveScene?: (sceneId: string, params: UpdateSceneParams) => Promise<void>;
  onCreateManualScript?: (planningId: string) => Promise<Script>;  // 削除
  onAddScene?: (params: CreateSceneParams) => Promise<Scene>;      // 削除
  className?: string;
}

// After
interface ScriptGenerationStepProps {
  projectId: string;
  planningId: string | null;
  script: Script | null;
  scenes: Scene[];
  status: ScriptGenerationStatus;
  onScriptGenerated?: (script: Script, scenes: Scene[]) => void;
  onSceneUpdated?: (scene: Scene) => void;
  onSaveScene?: (sceneId: string, params: UpdateSceneParams) => Promise<void>;
  className?: string;
}
```

### 3. project-detail-client.tsx の変更

- `ScriptGenerationStep` への `onCreateManualScript` prop 削除
- `onAddScene` prop 削除

### 4. use-script-generation.ts の扱い

`createManualScript` と `addScene` 関数は以下の理由から**今回は削除しない**：

- バックエンドAPIとの対応関係がある
- 削除するとAPIルートも削除が必要になり変更範囲が広がる

## 影響範囲

### フロントエンド

- `script-generation-step.tsx` - 主な変更対象
- `project-detail-client.tsx` - props削除のみ

### バックエンド

変更なし（APIは残す）

### 型定義

変更なし

## テスト

### 手動テスト項目

1. 企画書作成後、台本ステップが表示される
2. モード選択画面が表示されず、直接チャットUIが表示される
3. チャットで台本生成を指示できる
4. 生成されたシーンが一覧表示される
5. 既存シーンの編集が正常に動作する

## 実装手順

1. `script-generation-step.tsx` からモード選択UIと手動モード関連ロジックを削除
2. `project-detail-client.tsx` から不要なpropsを削除
3. 動作確認

