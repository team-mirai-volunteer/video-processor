# 文字起こし保存先を固定フォルダに変更

## 目的

**開発者・運用者**が**親フォルダ取得が不安定で文字起こしファイルが保存されないケースがある状態**を解消するため

## 背景

現在の `CreateTranscriptUseCase` では、動画ファイルの親フォルダを取得し、そこに「ショート用」フォルダを作成して文字起こしを保存している。しかし、Google Drive APIの権限設定や共有ドライブの仕様により、`parents` フィールドが取得できないケースがある。

```typescript
// 現在の問題箇所（create-transcript.usecase.ts:115-139）
const videoMetadata = await this.storageGateway.getFileMetadata(video.googleDriveFileId);
const parentFolderId = videoMetadata.parents?.[0];

if (parentFolderId) {
  // 親フォルダが取得できた場合のみ保存
} else {
  this.log('Warning: Could not find parent folder for video, skipping transcript upload');
}
```

## 設計

### 変更方針

1. 固定の文字起こし保存先フォルダIDを環境変数で設定可能にする
2. 固定フォルダ配下に「動画名」ディレクトリを作成し、その中に文字起こしファイルを保存する
3. 既存の「ショート用」フォルダへの保存ロジックは削除する

### 保存先フォルダ構成

```
指定フォルダ (1F4HoO2h71B3OAD3VJ8-TEicNHTdfhwE2)
└── {動画名}/
    └── {動画名}_文字起こし.txt
```

### 環境変数

| 変数名 | 説明 | 用途 |
|--------|------|------|
| `TRANSCRIPT_OUTPUT_FOLDER_ID` | 文字起こし保存先フォルダID | 本番用 |
| `GOOGLE_DRIVE_OUTPUT_FOLDER_ID` | テスト用出力フォルダID | Integration Test用 |

- 本番用: `TRANSCRIPT_OUTPUT_FOLDER_ID=1F4HoO2h71B3OAD3VJ8-TEicNHTdfhwE2`
- Integration Test用: `GOOGLE_DRIVE_OUTPUT_FOLDER_ID=1ypNqVlm-saQHZUrXkGVSxBkMudVZej5f`（既存の環境変数をそのまま使用）

### 変更ファイル

| ファイル | 変更内容 |
|----------|----------|
| [apps/backend/src/application/usecases/create-transcript.usecase.ts](apps/backend/src/application/usecases/create-transcript.usecase.ts) | 保存先ロジックの変更 |
| [apps/backend/src/infrastructure/config/env.ts](apps/backend/src/infrastructure/config/env.ts) | 環境変数の追加 |
| `.env.example` | 環境変数サンプルの追加 |

### 処理フロー

```
1. 文字起こし完了
2. 環境変数 TRANSCRIPT_OUTPUT_FOLDER_ID から保存先フォルダIDを取得
3. 動画名から拡張子を除去
4. 保存先フォルダ内に「動画名」フォルダを findOrCreate
5. 「動画名」フォルダ内に「{動画名}_文字起こし.txt」をアップロード
```

### エラーハンドリング

現在の実装と同様、Google Driveへのアップロードは best effort とし、失敗しても文字起こし処理全体は失敗させない。ただし、環境変数が未設定の場合は警告ログを出力してスキップする。

## 影響範囲

- 既存の「ショート用」フォルダへの保存は行われなくなる
- 新規に `TRANSCRIPT_OUTPUT_FOLDER_ID` 環境変数の設定が必要
- 既存の `GOOGLE_DRIVE_OUTPUT_FOLDER_ID` はIntegration Test専用として引き続き使用
