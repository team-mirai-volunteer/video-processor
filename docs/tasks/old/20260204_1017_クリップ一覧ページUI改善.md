# クリップ一覧ページUI改善

## 目的

クリップ一覧ページの利用者が、各クリップの長さと全文の内容をより素早く把握できるようにするため。

## 改善内容

### 1. 動画長（duration）の表示追加

クリップ一覧テーブルに「動画長」カラムを追加し、各クリップの長さを表示する。

### 2. 切り抜き文章の表示改善

- 現在の100文字cropを短くする（50文字程度を想定）
- ブラウザネイティブの`title`属性ではなく、shadcn/uiの`Tooltip`コンポーネントを使用して即時表示を実現する

## 現状

### フロントエンド

- **テーブルコンポーネント**: [apps/webapp/src/components/features/clip-list/clip-list-table.tsx](../apps/webapp/src/components/features/clip-list/clip-list-table.tsx)
- **現在のカラム**: 元動画 / クリップタイトル / 切り抜き文章 / 作成日時 / リンク
- **切り抜き文章**: `truncateText(text, 100)` で100文字にcrop、HTML `title`属性でツールチップ表示

### バックエンドAPI

- **API**: `GET /api/clips`
- **UseCase**: [apps/backend/src/contexts/clip-video/application/usecases/get-all-clips.usecase.ts](../apps/backend/src/contexts/clip-video/application/usecases/get-all-clips.usecase.ts)
- **レスポンス型 `AllClipSummary`**: `durationSeconds` が含まれていない

### データベース

- **Clipテーブル**: `duration_seconds` カラムが存在（Decimal(10,3)）
- ドメインモデル `Clip` にも `durationSeconds` プロパティは存在

## 修正箇所

### バックエンド

| ファイル | 修正内容 |
|----------|----------|
| `apps/backend/src/contexts/clip-video/application/usecases/get-all-clips.usecase.ts` | `AllClipSummary` 型に `durationSeconds: number` を追加、レスポンスマッピングに `durationSeconds` を追加 |

### 共有型定義（apps/shared）

| ファイル | 修正内容 |
|----------|----------|
| `apps/shared/types/api.ts` | `AllClipSummary` 型に `durationSeconds: number` を追加 |

### フロントエンド

| ファイル | 修正内容 |
|----------|----------|
| `apps/webapp/src/components/ui/tooltip.tsx` | shadcn/ui Tooltipコンポーネントを追加（`npx shadcn@latest add tooltip`） |
| `apps/webapp/src/components/features/clip-list/clip-list-table.tsx` | 1. 「動画長」カラムを追加 2. 切り抜き文章のcropを50文字に変更 3. `title`属性を`Tooltip`コンポーネントに置き換え |

## テーブル表示（変更後）

| 元動画 | クリップタイトル | 動画長 | 切り抜き文章 | 作成日時 | リンク |
|--------|------------------|--------|--------------|----------|--------|
| video.mp4 | タイトル | 1:30 | また今回の選挙では他の政党は我々を除くほぼ全ての政党は消... | 2026/02/03 18:11 | GDrive |

## 動画長のフォーマット

`durationSeconds`（秒数）を `MM:SS` 形式で表示する。

- 60秒未満: `0:45`
- 60秒以上: `1:30`
- 60分以上: `1:00:30`（該当ケースは稀）
